<div class="candidates-dashboard">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="title-section">
        <h1 class="main-title">
          Candidates Directory
        </h1>
        <p class="subtitle">Manage and oversee all registered candidates</p>
      </div>
      <div class="header-stats">
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-user-check"></i>
          </div>
          <div class="stat-info">
            <span class="stat-number">{{ candidates.length }}</span>
            <span class="stat-label">Total Candidates</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search and Filters Section -->
  <div class="controls-section">
    <div class="search-container">
      <div class="search-box">
        <i class="fas fa-search search-icon"></i>
        <input 
          type="text" 
          placeholder="Search candidates by name, email, or role..." 
          class="search-input"
          [(ngModel)]="searchTerm"
          (input)="filterCandidates()"
        />
      </div>
    </div>
    <div class="filter-container">
      <select class="filter-select" [(ngModel)]="statusFilter" (change)="filterCandidates()">
        <option value="">All Status</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
    </div>
  </div>

  <!-- Candidates Table Section -->
  <div class="table-section" *ngIf="filteredCandidates.length > 0; else noCandidates">
    <div class="table-container">
      <table class="candidates-table">
        <thead>
          <tr>
            <th class="th-profile">Profile</th>
            <th class="th-name">Full Name</th>
            <th class="th-email">Email</th>
            <th class="th-phone">Phone</th>
            <th class="th-role">Preferred Role</th>
            <th class="th-status">Status</th>
            <th class="th-date">Registered</th>
            <th class="th-actions">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let candidate of filteredCandidates" class="candidate-row">
            <td class="td-profile">
              <div class="profile-container">
                <img
                  class="candidate-avatar"
                  [src]="candidate.profilePictureUrl || 'assets/FrontOffice/images/default.avif'"
                  [alt]="candidate.fullName + ' profile picture'"
                />
                <div class="online-indicator" [class.online]="isCandidateOnline(candidate)"></div>
              </div>
            </td>
            <td class="td-name">
              <div class="name-container">
                <span class="candidate-name">{{ candidate.fullName }}</span>
                <span class="candidate-id">#{{ candidate.userId }}</span>
              </div>
            </td>
            <td class="td-email">
              <div class="email-container">
                <i class="fas fa-envelope email-icon"></i>
                <span class="email-text">{{ candidate.email }}</span>
              </div>
            </td>
            <td class="td-phone">
              <div class="phone-container">
                <i class="fas fa-phone phone-icon"></i>
                <span class="phone-text">{{ candidate.phoneNumber || 'â€”' }}</span>
              </div>
            </td>
            <td class="td-role">
              <div class="role-container">
                <span class="role-badge" *ngIf="candidate.preferredJobTitle; else noRole">
                  {{ candidate.preferredJobTitle }}
                </span>
                <ng-template #noRole>
                  <span class="no-role">Not specified</span>
                </ng-template>
              </div>
            </td>
            <td class="td-status">
              <div class="status-container">
                <span class="status-badge" [class.active]="isCandidateActive(candidate)" [class.inactive]="!isCandidateActive(candidate)">
                  <i class="fas fa-circle status-dot"></i>
                  {{ isCandidateActive(candidate) ? 'Active' : 'Inactive' }}
                </span>
              </div>
            </td>
            <td class="td-date">
              <div class="date-container">
                <span class="date-text">{{ candidate.createdAt | date:'MMM dd, yyyy' }}</span>
              </div>
            </td>
            <td class="td-actions">
              <div class="actions-container">
                <button 
                  [routerLink]="['/backoffice/candidate-profile', candidate.userId]" 
                  class="action-btn view-btn" 
                  title="View Profile"
                >
                  <i class="fas fa-eye"></i>
                </button>
                <button 
                  (click)="editCandidate(candidate)" 
                  class="action-btn edit-btn" 
                  title="Edit Candidate"
                >
                  <i class="fas fa-edit"></i>
                </button>
                <button 
                  (click)="deleteCandidate(candidate.userId)" 
                  class="action-btn delete-btn" 
                  title="Delete Candidate"
                >
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- No Candidates Template -->
  <ng-template #noCandidates>
    <div class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-user-slash"></i>
      </div>
      <h3 class="empty-title">No candidates found</h3>
      <p class="empty-description">
        {{ searchTerm || statusFilter ? 'Try adjusting your search criteria or filters.' : 'There are no candidates registered yet.' }}
      </p>
      <button class="btn-primary" (click)="clearFilters()" *ngIf="searchTerm || statusFilter">
        <i class="fas fa-times"></i>
        Clear Filters
      </button>
    </div>
  </ng-template>
</div>

<!-- Enhanced Edit Candidate Modal -->
<div class="modal-overlay" *ngIf="isEditModalOpen && selectedCandidate" (click)="closeModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title">
        <i class="fas fa-user-edit"></i>
        <h3>Edit Candidate Profile</h3>
      </div>
      <button class="modal-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label">
            <i class="fas fa-user"></i>
            Full Name
          </label>
          <input 
            [(ngModel)]="selectedCandidate.fullName" 
            type="text" 
            class="form-input"
            placeholder="Enter full name"
          />
        </div>

        <div class="form-group">
          <label class="form-label">
            <i class="fas fa-envelope"></i>
            Email Address
          </label>
          <input 
            [(ngModel)]="selectedCandidate.email" 
            type="email" 
            class="form-input"
            placeholder="Enter email address"
          />
        </div>

        <div class="form-group">
          <label class="form-label">
            <i class="fas fa-phone"></i>
            Phone Number
          </label>
          <input 
            [(ngModel)]="selectedCandidate.phoneNumber" 
            type="tel" 
            class="form-input"
            placeholder="Enter phone number"
          />
        </div>

        <div class="form-group">
          <label class="form-label">
            <i class="fas fa-briefcase"></i>
            Preferred Role
          </label>
          <input 
            [(ngModel)]="selectedCandidate.preferredJobTitle" 
            type="text" 
            class="form-input"
            placeholder="Enter preferred job title"
          />
        </div>

        <div class="form-group full-width">
          <label class="form-label">
            <i class="fab fa-linkedin"></i>
            LinkedIn URL
          </label>
          <input 
            [(ngModel)]="selectedCandidate.linkedinUrl" 
            type="url" 
            class="form-input"
            placeholder="Enter LinkedIn profile URL"
          />
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeModal()">
        <i class="fas fa-times"></i>
        Cancel
      </button>
      <button class="btn-primary" (click)="saveChanges()">
        <i class="fas fa-save"></i>
        Save Changes
      </button>
    </div>
  </div>
</div>
