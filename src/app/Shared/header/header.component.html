<header class="main-header">
  <div class="container">
    <a class="logo" routerLink="/">
  <img src="assets/FrontOffice/images/smartcruit.png" alt="SmartCruit Logo" />
</a>


    <!-- Authenticated Navigation -->
    <ng-container *ngIf="(currentUser$ | async) as user; else publicHeader">
      <nav class="nav-links">
        <!-- ADMIN -->
        <ng-container *ngIf="user.role === 'admin'; else notAdmin">
          <a routerLink="/backoffice/dashboard" routerLinkActive="active">
            Dashboard
          </a>
          <a routerLink="/backoffice/employers" routerLinkActive="active">
            Employers
          </a>
          <a routerLink="/backoffice/candidates" routerLinkActive="active">
            Candidates
          </a>
          <a routerLink="/backoffice/company" routerLinkActive="active">
            Companies
          </a>

          <a routerLink="/backoffice/job-offers" routerLinkActive="active">
            Job Offers
          </a>
        
        </ng-container>

        <!-- EMPLOYER / CANDIDATE -->
        <ng-template #notAdmin>
          <!-- Employer -->
          <ng-container *ngIf="user.role === 'employer'; else candidateNav">
            <a routerLink="/employer/dashboard" routerLinkActive="active">
              Dashboard
            </a>
            <a routerLink="/employer/job-offers" routerLinkActive="active">
              Job Offers
            </a>
           
          </ng-container>

          <!-- Candidate -->
          <ng-template #candidateNav>
            <a routerLink="/" routerLinkActive="active">
              Home
            </a>
            <a routerLink="/job-offers" routerLinkActive="active">
              Find Jobs
            </a>
            <a href="/support" routerLinkActive="active">
              Support
            </a>
            <a routerLink="/aboutUs" routerLinkActive="active">
              About Us
            </a>
           
          </ng-template>
        </ng-template>
      </nav>

      <!-- Logged-In Dropdown -->
      <div class="user-bar">
       <div class="notification-icon">
  <a routerLink="/notifications" routerLinkActive="active">
    <i class="fas fa-bell"></i>
    <span *ngIf="unreadCount > 0" class="notification-badge">{{ unreadCount }}</span>
  </a>
</div>


        <div class="user-dropdown">
          <div class="user-trigger">
            <img
              class="user-avatar"
              [src]="user.profilePictureUrl || 'assets/FrontOffice/images/default.avif'"
              alt="User Avatar"
            />
            <span class="user-name">{{ user.fullName }}</span>
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="dropdown-menu">
            <a routerLink="/profile">
              Profile
            </a>
            <a *ngIf="recipientId" [routerLink]="['/chat']" [queryParams]="{ to: recipientId }">
              Messages
            </a>
             <!-- Favorites: show only if role is 'candidate' -->
           <a *ngIf="user.role === 'candidate'" routerLink="/favorites">
              Favorites
           </a>
           <a *ngIf="user.role === 'candidate' || user.role === 'employer'" routerLink="/interviews">
  My Interviews
  <span *ngIf="pendingInterviewCount > 0" class="badge">{{ pendingInterviewCount }}</span>
</a>

            <a href="/settings">
              Settings
            </a>
           
          </div>
          
        </div>
        <div class="logout-text" (click)="logout()" title="Logout">
          Logout
        </div>
        
      </div>
    </ng-container>

    <!-- Public Header (Unauthenticated) -->
    <ng-template #publicHeader>
      <nav class="nav-links">
        <a routerLink="/" routerLinkActive="active">
          Home
        </a>
        <a routerLink="/job-offers" routerLinkActive="active">
          Find Jobs
        </a>
        <a href="#" routerLinkActive="active">
          Support
        </a>
        <a routerLink="/aboutUs" routerLinkActive="active">
          About Us
        </a>
        <a href="#" routerLinkActive="active">
          Testimonials
        </a>
      </nav>
      <div class="auth-buttons">
        <a routerLink="/login" class="btn login-btn">
          Login
        </a>
        <a routerLink="/signup" class="btn signup-btn">
          Sign Up
        </a>
      </div>
    </ng-template>
  </div>
</header>
